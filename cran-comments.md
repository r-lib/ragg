Moving `sprintf()` to `snprintf()` at request of cran along with a few bug fixes
